-- MySQL Script generated by MySQL Workbench
-- 08/04/15 12:31:23
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='TRADITIONAL,ALLOW_INVALID_DATES';

-- -----------------------------------------------------
-- Schema mydb
-- -----------------------------------------------------
-- -----------------------------------------------------
-- Schema infostretchreferralsql
-- -----------------------------------------------------

-- -----------------------------------------------------
-- Schema infostretchreferralsql
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `infostretchreferralsql` DEFAULT CHARACTER SET latin1 ;
USE `infostretchreferralsql` ;

-- -----------------------------------------------------
-- Table `infostretchreferralsql`.`user`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `infostretchreferralsql`.`user` (
  `id` INT(11) NOT NULL AUTO_INCREMENT,
  `name` VARCHAR(200) NULL DEFAULT NULL,
  `email` VARCHAR(200) NULL DEFAULT NULL,
  `password` VARCHAR(200) NULL DEFAULT NULL,
  PRIMARY KEY (`id`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = latin1;

ALTER TABLE `infostretchreferralsql`.`user` 
ADD COLUMN `firstname` VARCHAR(100) NULL AFTER `password`,
ADD COLUMN `lastname` VARCHAR(100) NULL AFTER `firstname`;

-- -----------------------------------------------------
-- Table `infostretchreferralsql`.`employee_referral`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `infostretchreferralsql`.`employee_referral` (
  `id` INT(11) NOT NULL AUTO_INCREMENT,
  `candidate_name` VARCHAR(200) NULL DEFAULT NULL,
  `created_by` INT(11) NULL DEFAULT NULL,
  `email` VARCHAR(200) NULL DEFAULT NULL,
  `phone` VARCHAR(20) NULL DEFAULT NULL,
  `linkedin_url` VARCHAR(500) NULL DEFAULT NULL,
  `is_attachment` TINYINT(1) NULL DEFAULT NULL,
  `is_contact` TINYINT(1) NULL DEFAULT NULL,
  `is_viable` TINYINT(1) NULL DEFAULT NULL,
  `is_close` TINYINT(1) NULL DEFAULT NULL,
  `created_on` DATETIME NULL DEFAULT NULL,
  `updated_on` DATETIME NULL DEFAULT NULL,
  `updated_by` INT(11) NULL DEFAULT NULL,
  PRIMARY KEY (`id`),
  INDEX `fk_employee_createdby_idx` (`created_by` ASC),
  INDEX `fk_employee_updatedby_idx` (`updated_by` ASC),
  CONSTRAINT `fk_employee_createdby`
    FOREIGN KEY (`created_by`)
    REFERENCES `infostretchreferralsql`.`user` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_employee_updatedby`
    FOREIGN KEY (`updated_by`)
    REFERENCES `infostretchreferralsql`.`user` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = latin1;
ALTER TABLE `infostretchreferralsql`.`employee_referral` 
CHANGE COLUMN `candidate_name` `candidate_name` VARCHAR(200) NOT NULL ,
CHANGE COLUMN `email` `email` VARCHAR(200) NOT NULL ;
DELETE FROM `infostretchreferralsql`.`employee_referral` WHERE `id`='18';
DELETE FROM `infostretchreferralsql`.`employee_referral` WHERE `id`='19';

UPDATE `infostretchreferralsql`.`user` SET `firstname`='Aneri', `lastname`='Parikh' WHERE `id`='1';
UPDATE `infostretchreferralsql`.`user` SET `firstname`='Pratik', `lastname`='Oza' WHERE `id`='2';
UPDATE `infostretchreferralsql`.`user` SET `firstname`='Vaibhavi', `lastname`='Joshi' WHERE `id`='3';
ALTER TABLE `infostretchreferralsql`.`sales_referral` 
CHANGE COLUMN `company_name` `company_name` VARCHAR(500) NOT NULL ,
CHANGE COLUMN `phone` `phone` VARCHAR(20) NULL ;

-- -----------------------------------------------------
-- Table `infostretchreferralsql`.`role`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `infostretchreferralsql`.`role` (
  `id` INT(11) NOT NULL AUTO_INCREMENT,
  `role_name` VARCHAR(200) NULL DEFAULT NULL,
  PRIMARY KEY (`id`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = latin1;


-- -----------------------------------------------------
-- Table `infostretchreferralsql`.`sales_referral`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `infostretchreferralsql`.`sales_referral` (
  `id` INT(11) NOT NULL AUTO_INCREMENT,
  `contact_name` VARCHAR(200) NULL DEFAULT NULL,
  `company_name` VARCHAR(500) NULL DEFAULT NULL,
  `created_by` INT(11) NULL DEFAULT NULL,
  `email` VARCHAR(200) NULL DEFAULT NULL,
  `phone` VARCHAR(20) NULL DEFAULT NULL,
  `comments` TEXT NULL DEFAULT NULL,
  `is_contact` TINYINT(1) NULL DEFAULT NULL,
  `is_viable` TINYINT(1) NULL DEFAULT NULL,
  `is_close` TINYINT(1) NULL DEFAULT NULL,
  `created_on` DATETIME NULL DEFAULT NULL,
  `updated_on` DATETIME NULL DEFAULT NULL,
  `updated_by` INT(11) NULL DEFAULT NULL,
  PRIMARY KEY (`id`),
  INDEX `fk_sales_createdby_idx` (`created_by` ASC),
  INDEX `fk_sales_updatedby_idx` (`updated_by` ASC),
  CONSTRAINT `fk_sales_createdby`
    FOREIGN KEY (`created_by`)
    REFERENCES `infostretchreferralsql`.`user` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_sales_updatedby`
    FOREIGN KEY (`updated_by`)
    REFERENCES `infostretchreferralsql`.`user` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = latin1;

ALTER TABLE `infostretchreferralsql`.`sales_referral` 
CHANGE COLUMN `contact_name` `contact_name` VARCHAR(200) NOT NULL ,
CHANGE COLUMN `email` `email` VARCHAR(200) NOT NULL ,
CHANGE COLUMN `phone` `phone` VARCHAR(20) NOT NULL ;

-- -----------------------------------------------------
-- Table `infostretchreferralsql`.`user_role_mapping`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `infostretchreferralsql`.`user_role_mapping` (
  `id` INT(11) NOT NULL AUTO_INCREMENT,
  `role_id` INT(11) NOT NULL,
  `user_id` INT(11) NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE INDEX `uk_role_user` (`role_id` ASC, `user_id` ASC),
  INDEX `fk_user_id_idx` (`user_id` ASC),
  UNIQUE INDEX `uk_user_role` (`role_id` ASC, `user_id` ASC),
  CONSTRAINT `fk_role_id`
    FOREIGN KEY (`role_id`)
    REFERENCES `infostretchreferralsql`.`role` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_user_id`
    FOREIGN KEY (`user_id`)
    REFERENCES `infostretchreferralsql`.`user` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = latin1;


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;
